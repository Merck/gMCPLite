<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Implements the graphical test procedure described in Bretz et al. (2009).
Note that the gMCP function in the gMCP package performs the same task."><title>Multiple testing using graphs — graphTest • gMCPLite</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Multiple testing using graphs — graphTest"><meta property="og:description" content="Implements the graphical test procedure described in Bretz et al. (2009).
Note that the gMCP function in the gMCP package performs the same task."><meta property="og:image" content="https://merck.github.io/gMCPLite/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gMCPLite</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/GraphicalMultiplicity.html">Graphical testing for group sequential design</a>
    <a class="dropdown-item" href="../articles/hGraph.html">Multiplicity graphs</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Merck/gMCPLite/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multiple testing using graphs</h1>
      <small class="dont-index">Source: <a href="https://github.com/Merck/gMCPLite/blob/HEAD/R/graphTest.R" class="external-link"><code>R/graphTest.R</code></a></small>
      <div class="d-none name"><code>graphTest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the graphical test procedure described in Bretz et al. (2009).
Note that the gMCP function in the gMCP package performs the same task.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">graphTest</span><span class="op">(</span></span>
<span>  <span class="va">pvalues</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  G <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  graph <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">test</span>,</span>
<span>  upscale <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>pvalues</dt>
<dd><p>Either a vector or a matrix containing the local p-values for
the hypotheses in the rows.</p></dd>


<dt>weights</dt>
<dd><p>Initial weight levels for the test procedure, in case of
multiple graphs this needs to be a matrix.</p></dd>


<dt>alpha</dt>
<dd><p>Overall alpha level of the procedure. For entangled graphs
<code>alpha</code> should be a numeric vector of length equal to the number of
graphs, each element specifying the partial alpha for the respective graph.
The overall alpha level equals <code>sum(alpha)</code>.</p></dd>


<dt>G</dt>
<dd><p>For simple graphs <code>G</code> should be a numeric matrix determining
the graph underlying the test procedure. Note that the diagonal need to
contain only 0s, while the rows need to sum to 1.  For entangled graphs it
needs to be a list containing the different graph matrices as elements.</p></dd>


<dt>cr</dt>
<dd><p>Correlation matrix that should be used for the parametric test.
If <code>cr==NULL</code> the Bonferroni based test procedure is used.</p></dd>


<dt>graph</dt>
<dd><p>As an alternative to the specification via <code>weights</code> and
<code>G</code> one can also hand over a <code>graphMCP</code> object to the code.
<code>graphMCP</code> objects can be created for example with the <code>graphGUI</code>
function.</p></dd>


<dt>verbose</dt>
<dd><p>If verbose is TRUE, additional information about the
graphical rejection procedure is displayed.</p></dd>


<dt>test</dt>
<dd><p>In the parametric case there is more than one way to handle
subgraphs with less than the full alpha. If the parameter <code>test</code> is
missing, the tests are performed as described by Bretz et al. (2011), i.e.
tests of intersection null hypotheses always exhaust the full alpha level
even if the sum of weights is strictly smaller than one. If
<code>test="simple-parametric"</code> the tests are performed as defined in
Equation (3) of Bretz et al. (2011).</p></dd>


<dt>upscale</dt>
<dd><p>Logical. If <code>upscale=FALSE</code> then for each intersection
of hypotheses (i.e. each subgraph) a weighted test is performed at the
possibly reduced level alpha of sum(w)*alpha,
where sum(w) is the sum of all node weights in this subset.
If <code>upscale=TRUE</code> all weights are upscaled, so that sum(w)=1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A vector or a matrix containing the test results for the hypotheses
under consideration. Significant tests are denoted by a 1, non-significant
results by a 0.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bretz, F., Maurer, W., Brannath, W. and Posch, M. (2009) A graphical
approach to sequentially rejective multiple test procedures. Statistics in
Medicine, 28, 586--604</p>
<p>Bretz, F., Maurer, W. and Hommel, G. (2010) Test and power considerations
for multiple endpoint analyses using sequentially rejective graphical
procedures, to appear in Statistics in Medicine</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### example from Bretz et al. (2010)</span></span></span>
<span class="r-in"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,       <span class="fl">0.5</span>, <span class="fl">0</span>,     <span class="fl">0.5</span>, <span class="fl">0</span>,      <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,     <span class="fl">0</span>,   <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,    <span class="fl">0</span>,   <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,    <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,       <span class="fl">0.5</span>, <span class="fl">0</span>,     <span class="fl">0</span>,   <span class="fl">0</span>,      <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,       <span class="fl">1</span>,   <span class="fl">0</span>,     <span class="fl">0</span>,   <span class="fl">0</span>,      <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,     <span class="fl">0</span>,   <span class="fl">0.5</span>,   <span class="fl">0</span>,   <span class="fl">0</span>,      <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,       <span class="fl">1</span>,   <span class="fl">0</span>,     <span class="fl">0</span>,   <span class="fl">0</span>,      <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.008</span>, <span class="fl">0.005</span>, <span class="fl">0.15</span>, <span class="fl">0.04</span>, <span class="fl">0.006</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graphTest</span><span class="op">(</span><span class="va">pvals</span>, <span class="va">weights</span>, alpha<span class="op">=</span><span class="fl">0.025</span>, <span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H1 H2 H3 H4 H5 H6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0  1  1  0  0  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"last.alphas")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.016666667 0.000000000 0.000000000 0.000000000 0.008333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"last.G")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]      [,4]      [,5] [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.0    0    0 0.6666667 0.3333333    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0    0    0 0.0000000 0.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0    0    0 0.0000000 0.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.5    0    0 0.0000000 0.5000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  1.0    0    0 0.0000000 0.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.0    0    0 0.0000000 0.0000000    0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## observe graphical procedure in detail</span></span></span>
<span class="r-in"><span><span class="fu">graphTest</span><span class="op">(</span><span class="va">pvals</span>, <span class="va">weights</span>, alpha<span class="op">=</span><span class="fl">0.025</span>, <span class="va">graph</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reject hypothesis 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updated alphas and graph:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a1: 0.011 a2: 0.000 a3: 0.011 a4: 0.000 a5: 0.003 a6: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G11: 0.000 G12: 0.000 G13: 0.200 G14: 0.600 G15: 0.200 G16: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G21: 0.000 G22: 0.000 G23: 0.000 G24: 0.000 G25: 0.000 G26: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G31: 0.200 G32: 0.000 G33: 0.000 G34: 0.000 G35: 0.200 G36: 0.600 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G41: 0.333 G42: 0.000 G43: 0.333 G44: 0.000 G45: 0.333 G46: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G51: 0.500 G52: 0.000 G53: 0.500 G54: 0.000 G55: 0.000 G56: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G61: 0.333 G62: 0.000 G63: 0.333 G64: 0.000 G65: 0.333 G66: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reject hypothesis 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updated alphas and graph:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a1: 0.013 a2: 0.000 a3: 0.000 a4: 0.000 a5: 0.005 a6: 0.007 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G11: 0.000 G12: 0.000 G13: 0.000 G14: 0.625 G15: 0.250 G16: 0.125 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G21: 0.000 G22: 0.000 G23: 0.000 G24: 0.000 G25: 0.000 G26: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G31: 0.000 G32: 0.000 G33: 0.000 G34: 0.000 G35: 0.000 G36: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G41: 0.400 G42: 0.000 G43: 0.000 G44: 0.000 G45: 0.400 G46: 0.200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G51: 0.667 G52: 0.000 G53: 0.000 G54: 0.000 G55: 0.000 G56: 0.333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G61: 0.500 G62: 0.000 G63: 0.000 G64: 0.000 G65: 0.500 G66: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reject hypothesis 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updated alphas and graph:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a1: 0.017 a2: 0.000 a3: 0.000 a4: 0.000 a5: 0.008 a6: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G11: 0.000 G12: 0.000 G13: 0.000 G14: 0.667 G15: 0.333 G16: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G21: 0.000 G22: 0.000 G23: 0.000 G24: 0.000 G25: 0.000 G26: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G31: 0.000 G32: 0.000 G33: 0.000 G34: 0.000 G35: 0.000 G36: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G41: 0.500 G42: 0.000 G43: 0.000 G44: 0.000 G45: 0.500 G46: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G51: 1.000 G52: 0.000 G53: 0.000 G54: 0.000 G55: 0.000 G56: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G61: 0.000 G62: 0.000 G63: 0.000 G64: 0.000 G65: 0.000 G66: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H1 H2 H3 H4 H5 H6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0  1  1  0  0  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"last.alphas")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.016666667 0.000000000 0.000000000 0.000000000 0.008333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"last.G")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]      [,4]      [,5] [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.0    0    0 0.6666667 0.3333333    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0    0    0 0.0000000 0.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0    0    0 0.0000000 0.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.5    0    0 0.0000000 0.5000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  1.0    0    0 0.0000000 0.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.0    0    0 0.0000000 0.0000000    0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## now use many p-values (useful for power simulations)</span></span></span>
<span class="r-in"><span><span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">6e4</span>, <span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">graphTest</span><span class="op">(</span><span class="va">pvals</span>, <span class="va">weights</span>, alpha<span class="op">=</span><span class="fl">0.025</span>, <span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1 H2 H3 H4 H5 H6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0  1  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  1  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0  0  0  0  0  0</span>
<span class="r-in"><span><span class="co"># example using multiple graphs (instead of 1)</span></span></span>
<span class="r-in"><span><span class="va">G1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">-</span><span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">G2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.01</span>, <span class="fl">1</span><span class="op">-</span><span class="fl">0.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.012</span>, <span class="fl">0.025</span>, <span class="fl">0.005</span>, <span class="fl">0.0015</span>, <span class="fl">0.0045</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">graphTest</span><span class="op">(</span><span class="va">pvals</span>, <span class="va">weights</span>, alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0125</span>, <span class="fl">0.0125</span><span class="op">)</span>, G<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reject hypothesis 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updated alphas and graphs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a11: 0.000 a12: 0.006 a13: 0.006 a14: 0.000 a15: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,11: 0.000 G1,12: 0.000 G1,13: 0.000 G1,14: 0.000 G1,15: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,21: 0.000 G1,22: 0.000 G1,23: 1.000 G1,24: 0.000 G1,25: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,31: 0.000 G1,32: 0.000 G1,33: 0.000 G1,34: 0.990 G1,35: 0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,41: 0.000 G1,42: 1.000 G1,43: 0.000 G1,44: 0.000 G1,45: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,51: 0.000 G1,52: 0.000 G1,53: 0.000 G1,54: 0.000 G1,55: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a21: 0.000 a22: 0.013 a23: 0.000 a24: 0.000 a25: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,11: 0.000 G2,12: 0.000 G2,13: 0.000 G2,14: 0.000 G2,15: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,21: 0.000 G2,22: 0.000 G2,23: 1.000 G2,24: 0.000 G2,25: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,31: 0.000 G2,32: 0.000 G2,33: 0.000 G2,34: 0.010 G2,35: 0.990 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,41: 0.000 G2,42: 0.000 G2,43: 0.000 G2,44: 0.000 G2,45: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,51: 0.000 G2,52: 0.000 G2,53: 1.000 G2,54: 0.000 G2,55: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reject hypothesis 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updated alphas and graphs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a11: 0.000 a12: 0.006 a13: 0.000 a14: 0.006 a15: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,11: 0.000 G1,12: 0.000 G1,13: 0.000 G1,14: 0.000 G1,15: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,21: 0.000 G1,22: 0.000 G1,23: 0.000 G1,24: 0.990 G1,25: 0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,31: 0.000 G1,32: 0.000 G1,33: 0.000 G1,34: 0.000 G1,35: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,41: 0.000 G1,42: 1.000 G1,43: 0.000 G1,44: 0.000 G1,45: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,51: 0.000 G1,52: 0.000 G1,53: 0.000 G1,54: 0.000 G1,55: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a21: 0.000 a22: 0.013 a23: 0.000 a24: 0.000 a25: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,11: 0.000 G2,12: 0.000 G2,13: 0.000 G2,14: 0.000 G2,15: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,21: 0.000 G2,22: 0.000 G2,23: 0.000 G2,24: 0.010 G2,25: 0.990 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,31: 0.000 G2,32: 0.000 G2,33: 0.000 G2,34: 0.000 G2,35: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,41: 0.000 G2,42: 0.000 G2,43: 0.000 G2,44: 0.000 G2,45: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,51: 0.000 G2,52: 0.000 G2,53: 0.000 G2,54: 1.000 G2,55: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reject hypothesis 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updated alphas and graphs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a11: 0.000 a12: 0.012 a13: 0.000 a14: 0.000 a15: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,11: 0.000 G1,12: 0.000 G1,13: 0.000 G1,14: 0.000 G1,15: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,21: 0.000 G1,22: 0.000 G1,23: 0.000 G1,24: 0.000 G1,25: 1.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,31: 0.000 G1,32: 0.000 G1,33: 0.000 G1,34: 0.000 G1,35: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,41: 0.000 G1,42: 0.000 G1,43: 0.000 G1,44: 0.000 G1,45: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1,51: 0.000 G1,52: 0.000 G1,53: 0.000 G1,54: 0.000 G1,55: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a21: 0.000 a22: 0.013 a23: 0.000 a24: 0.000 a25: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,11: 0.000 G2,12: 0.000 G2,13: 0.000 G2,14: 0.000 G2,15: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,21: 0.000 G2,22: 0.000 G2,23: 0.000 G2,24: 0.000 G2,25: 0.990 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,31: 0.000 G2,32: 0.000 G2,33: 0.000 G2,34: 0.000 G2,35: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,41: 0.000 G2,42: 0.000 G2,43: 0.000 G2,44: 0.000 G2,45: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2,51: 0.000 G2,52: 0.000 G2,53: 0.000 G2,54: 0.000 G2,55: 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## now again with many p-values</span></span></span>
<span class="r-in"><span><span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">5e4</span>, <span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">graphTest</span><span class="op">(</span><span class="va">pvals</span>, <span class="va">weights</span>, alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0125</span>, <span class="fl">0.0125</span><span class="op">)</span>, G<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1 H2 H3 H4 H5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  1  1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  1  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0  0  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  1  1  0  0  0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yalin Zhu, Yilong Zhang, Xuan Deng, Keaven Anderson, Nan Xiao. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6. <br>Copyright © 2022 Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates. All rights reserved.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p><span></span></p>
</div>

    </footer></div>

  

  

  </body></html>

